# Docker 安装 Mysql

## 下载镜像
```bash
$ sudo docker pull mysql:5.7
```

## 创建Host文件挂载点
```bash
$ sudo mkdir -p /docker/mysql/etc
$ sudo mkdir -p /docker/mysql/data
$ sudo vim /docker/mysql/etc/my.cnf
写入内容如下
[mysqld]
max_connections=200
explicit_defaults_for_timestamp=true
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci
```

## 生成初始化数据
```bash
$ sudo docker run  -v /docker/mysql/etc/my.cnf:/etc/mysql/my.cnf  -v /docker/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7
```
登录另外一个终端结束上面运行点命令，并清理容器
```bash
$ sudo docker ps -a
$ sudo docker stop [CONTAINER ID]
$ sudo docker rm [CONTAINER ID]
```

## 交互方式运行容器并初始化用户
```bash
$ sudo docker run -it -v /docker/mysql/etc/my.cnf:/etc/mysql/my.cnf -v /docker/mysql/data/:/var/lib/mysql mysql:5.7 /bin/bash
$ mysqld_safe&
$ mysql -u root -p
	mysql> grant all privileges on *.* to 'root'@'localhost' identified by '123456';
	mysql> grant all privileges on *.* to 'skyfish'@'%' identified by '123456';
	mysql> exit;
$ exit
```
清理容器
```bash
$ sudo docker ps -a
$ sudo docker rm [CONTAINER ID]
```

## 生成运行容器
```bash
$ sudo docker run --name mysql-server-5.7 -p 3306:3306 -v /docker/mysql/etc/my.cnf:/etc/mysql/my.cnf -v /docker/mysql/data:/var/lib/mysql -d --restart always mysql:5.7
```

## 创建数据库
```bash
$ mysql -h 192.168.0.11 -u skyfish -p
	mysql> CREATE DATABASE IF NOT EXISTS test DEFAULT CHARSET utf8mb4 COLLATE utf8mb4_unicode_ci;
```
