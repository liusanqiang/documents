
## kafka 安装
```bash
$ sudo useradd kafka 
$ sudo apt-get update
$ sudo apt-get install -y openjdk-8-jre
$ sudo mkdir -p /opt/kafka
$ sudo chown kafka:kafka /opt/kafka
$ sudo su kafka
$ cd /opt/kafka
$ wget https://mirrors.aliyun.com/apache/kafka/0.11.0.0/kafka_2.11-0.11.0.0.tgz
$ tar -xzf *.tgz
$ rm *.tgz
$ mkdir /opt/kafka/log
$ mkdir /opt/kafka/conf 

第一台
$ echo "broker.id=1" >> /opt/kafka/server.properties
第二台
$ echo "broker.id=2" >> /opt/kafka/server.properties
第三台
$ echo "broker.id=3" >> /opt/kafka/server.properties

$ echo "port=9092" >> /opt/kafka/server.properties
$ echo "num.network.threads=2" >> /opt/kafka/server.properties
$ echo "num.io.threads=6" >> /opt/kafka/server.properties
$ echo "log.dirs=/opt/kafka/log" >> /opt/kafka/server.properties
$ echo "default.replication.factor=3" >> /opt/kafka/server.properties
$ echo "message.max.byte=1024000" >> /opt/kafka/server.properties
$ echo "replica.fetch.max.bytes=1024000" >> /opt/kafka/server.properties
$ echo "zookeeper.connect=192.168.0.21:2181,192.168.0.22:2181,192.168.0.23:2181" >> /opt/kafka/server.properties
可选配置
$ echo "socket.send.buffer.bytes=102400" >> /opt/kafka/server.properties
$ echo "socket.receive.buffer.bytes=102400" >> /opt/kafka/server.properties
$ echo "socket.request.max.bytes=104857600" >> /opt/kafka/server.properties
$ echo "num.partitions=3" >> /opt/kafka/server.properties
$ echo "log.retention.hours=168" >> /opt/kafka/server.properties
$ echo "log.segment.bytes=1073741824" >> /opt/kafka/server.properties
$ echo "log.retention.check.interval.ms=300000" >> /opt/kafka/server.properties
$ echo "log.cleaner.enable=false" >> /opt/kafka/server.properties

```

## Ubuntu 开机启动
```bash
$ sudo vim /etc/init.d/kafka
内容如下:
#!/bin/sh
### BEGIN INIT INFO
# Provides:          kafka
# Required-start:    $local_fs $remote_fs $network $syslog
# Required-Stop:     $local_fs $remote_fs $network $syslog
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: starts the kafka daemon
# Description:       starts kafka using start-stop-daemon
### END INIT INFO

cd /opt/kafka

case "$1" in
  start)
    su zookeeper /opt/zookeeper/zookeeper-3.4.10/bin/zkServer.sh start /opt/zookeeper/conf/zoo.cfg
    ;;
  stop)
    su zookeeper /opt/zookeeper/zookeeper-3.4.10/bin/zkServer.sh stop /opt/zookeeper/conf/zoo.cfg
    ;;
  restart)
    $0 stop
    $0 start
    ;;
  *)
    echo "Usage: /etc/init.d/zookeeper {start|stop|restart}"
    exit 1
    ;;
esac

exit 0

$ sudo chmod a+x /etc/init.d/zookeeper

添加启动项
$ sudo update-rc.d zookeeper defaults
删除启动项
$ sudo update-rc.d zookeeper.sh remove

```
